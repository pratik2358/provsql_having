\section{Implementation}
\begin{algorithm}
  \caption{DP subset enumeration for $[\mathdutchcal{u}\oslash C]_=$}
  \begin{algorithmic}[1]
    \REQUIRE a dictionary $A \leftarrow \mathrm{supp}(\mathdutchcal{u})$ and a constant $C \in M$
    \ENSURE a list $\mathcal{R}$ of subsets of $A$, s.t. $\forall R \in \mathcal{R},\; \sum_{\mathbf{x}\in R}\mathbf{x}^{(M)}=C$
    \STATE Initialize $dp[0] \leftarrow \{\emptyset\}$ \COMMENT{list containing the empty subset}
    \FOR{$j \gets 1$ \TO $C$}
      \STATE $dp[j] \leftarrow \emptyset$ \COMMENT{$dp[j]$: all subsets realizing sum $j$}
    \ENDFOR
    \FOR{$i \gets 1$ \TO $|A|$}
      \STATE $w \gets A^{(M)}[i]$, $g \gets A^{(K)}[i]$
      \FOR{$j \gets C, C-1, \dots, w$}
        \STATE $p \gets j - w$
        \IF{$dp[p] \neq \emptyset$}
          \FORALL{$S \in dp[p]$}
            \STATE append $S \cup \{g\}$ to $dp[j]$
          \ENDFOR
        \ENDIF
      \ENDFOR
    \ENDFOR
    \STATE $\mathcal{R} \leftarrow dp[C]$
    \STATE \RETURN $\mathcal{R}$
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{Possible-world probability for $[\mathdutchcal{u}\oslash C]_=$}
  \begin{algorithmic}[1]
    \REQUIRE list $\mathcal{R}$ of subsets from Algorithm~1, full gate set $\mathcal{G}$, probabilities $p(g)$ for all $g \in \mathcal{G}$
    \ENSURE $\Pr\big([\mathdutchcal{u}\oslash C]_=\big)$
    \FORALL{$S \in \mathcal{R}$}
      \STATE $\pi \gets 1$
      \FORALL{$g \in \mathcal{G}$}
        \IF{$g \in S$}
          \STATE $\pi \gets \pi \cdot p(g)$
        \ELSE
          \STATE $\pi \gets \pi \cdot (1 - p(g))$
        \ENDIF
      \ENDFOR
      \STATE $P \gets P + \pi$
    \ENDFOR
    \STATE \RETURN $P$
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP possible-world for $[\mathdutchcal{u}\oslash C]_>$}
\begin{algorithmic}[1]
  \REQUIRE an array $A\leftarrow supp(\mathdutchcal{u})$, a constant $C$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP possible-world for $[\mathdutchcal{u}\oslash C]_<$}
\begin{algorithmic}[1]
  \REQUIRE an array $A\leftarrow supp(\mathdutchcal{u})$, a constant $C$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP possible-world for $[\mathdutchcal{u}\oslash C]_\geq$}
\begin{algorithmic}[1]
  \REQUIRE an array $A\leftarrow supp(\mathdutchcal{u})$, a constant $C$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP possible-world for $[\mathdutchcal{u}\oslash C]_\leq$}
\begin{algorithmic}[1]
  \REQUIRE an array $A\leftarrow supp(\mathdutchcal{u})$, a constant $C$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
\caption{Dynamic Algorithm for Probability of Subset Sum}
\label{alg:probability_subset_sum}
\begin{algorithmic}[1]
\REQUIRE $nums$: List of integers, $probs$: List of probabilities, $target$: Integer target sum
\ENSURE Dictionary of subsets summing to $target$ with their probabilities

\STATE Initialize $dp[0 \dots target]$ as an array of dictionaries
\STATE $dp[0] \gets \{() \to 1.0\}$ \COMMENT{Base case: one subset (empty) with probability 1.0}
\FOR{$i \gets 1$ to $|nums|$}
    \STATE $new\_dp[0 \dots target] \gets$ array of empty dictionaries
    \FOR{$t \gets target$ down to $nums[i-1]$}
        \IF{$dp[t - nums[i-1]] \neq \emptyset$}
            \FOR{each $(subset, subset\_prob)$ in $dp[t - nums[i-1]]$}
                \STATE $new\_subset \gets subset \cup \{nums[i-1]\}$
                \STATE $new\_prob \gets subset\_prob \times probs[i-1]$
                \IF{$new\_subset \in new\_dp[t]$}
                    \STATE $new\_dp[t][new\_subset] \gets new\_dp[t][new\_subset] + new\_prob$
                \ELSE
                    \STATE $new\_dp[t][new\_subset] \gets new\_prob$
                \ENDIF
            \ENDFOR
        \ENDIF
    \ENDFOR
    \FOR{$t \gets 0$ to $target$}
        \FOR{each $(subset, subset\_prob)$ in $new\_dp[t]$}
            \IF{$subset \in dp[t]$}
                \STATE $dp[t][subset] \gets dp[t][subset] + subset\_prob$
            \ELSE
                \STATE $dp[t][subset] \gets subset\_prob$
            \ENDIF
        \ENDFOR
    \ENDFOR
\ENDFOR
\RETURN $dp[target]$
\end{algorithmic}
\end{algorithm}
