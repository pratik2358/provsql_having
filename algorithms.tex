\section{Implementation}
\begin{algorithm}
  \caption{DP algorithm for $[\mathdutchcal{u}\oslash C]_=$}
  \begin{algorithmic}[1]
    \REQUIRE a dictionary $A \leftarrow \mathrm{supp}(\mathdutchcal{u})$ and a constant $C \in M$
    \ENSURE a list $\mathcal{R}$ of subsets of $A$, s.t. $\forall R \in \mathcal{R},\; \sum_{\mathbf{x}\in R}\mathbf{x}^{(M)}=C$
    \STATE Initialize $dp[0] \leftarrow \{\emptyset\}$ \COMMENT{list containing the empty subset}
    \FOR{$j \gets 1$ \TO $C$}
      \STATE $dp[j] \leftarrow \emptyset$ \COMMENT{$dp[j]$: all subsets realizing sum $j$}
    \ENDFOR
    \FOR{$i \gets 1$ \TO $|A|$}
      \STATE $w \gets A^{(M)}[i]$, $g \gets A^{(K)}[i]$
      \FOR{$j \gets C, C-1, \dots, w$}
        \STATE $p \gets j - w$
        \IF{$dp[p] \neq \emptyset$}
          \FORALL{$S \in dp[p]$}
            \STATE append $S \cup \{g\}$ to $dp[j]$
          \ENDFOR
        \ENDIF
      \ENDFOR
    \ENDFOR
    \STATE $\mathcal{R} \leftarrow dp[C]$
    \STATE \RETURN $\mathcal{R}$
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP algorithm for $[\mathdutchcal{u}\oslash C]_{>}$}
  \begin{algorithmic}[1]
    \REQUIRE a dictionary $A \leftarrow \mathrm{supp}(\mathdutchcal{u})$ and a constant $C \in M$
    \ENSURE a list $\mathcal{R}$ of subsets of $A$, s.t. $\forall R \in \mathcal{R},\; \sum_{\mathbf{x}\in R}\mathbf{x}^{(M)} > C$
    \STATE Let $T \gets \sum_{\mathbf{x}\in A}\mathbf{x}^{(M)}$ \COMMENT{max possible sum}
    \STATE Initialize $dp[0] \leftarrow \{\emptyset\}$ 
    \FOR{$j \gets 1$ \TO $T$}
      \STATE $dp[j] \leftarrow \emptyset$
    \ENDFOR
    \FOR{$i \gets 1$ \TO $|A|$}
      \STATE $w \gets A^{(M)}[i]$, $g \gets A^{(K)}[i]$
      \FOR{$j \gets T, T-1, \dots, w$}
        \STATE $p \gets j - w$
        \IF{$dp[p] \neq \emptyset$}
          \FORALL{$S \in dp[p]$}
            \STATE append $S \cup \{g\}$ to $dp[j]$
          \ENDFOR
        \ENDIF
      \ENDFOR
    \ENDFOR
    \STATE $\mathcal{R} \leftarrow \bigcup_{j=C+1}^{T} dp[j]$
    \STATE \RETURN $\mathcal{R}$
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP algorithm for $[\mathdutchcal{u}\oslash C]_{<}$}
  \begin{algorithmic}[1]
    \REQUIRE a dictionary $A \leftarrow \mathrm{supp}(\mathdutchcal{u})$ and a constant $C \in M$
    \ENSURE a list $\mathcal{R}$ of subsets of $A$, s.t. $\forall R \in \mathcal{R},\; \sum_{\mathbf{x}\in R}\mathbf{x}^{(M)} < C$
    \STATE Initialize $dp[0] \leftarrow \{\emptyset\}$ 
    \FOR{$j \gets 1$ \TO $C-1$}
      \STATE $dp[j] \leftarrow \emptyset$
    \ENDFOR
    \FOR{$i \gets 1$ \TO $|A|$}
      \STATE $w \gets A^{(M)}[i]$, $g \gets A^{(K)}[i]$
      \FOR{$j \gets C-1, C-2, \dots, w$}
        \STATE $p \gets j - w$
        \IF{$dp[p] \neq \emptyset$}
          \FORALL{$S \in dp[p]$}
            \STATE append $S \cup \{g\}$ to $dp[j]$
          \ENDFOR
        \ENDIF
      \ENDFOR
    \ENDFOR
    \STATE $\mathcal{R} \leftarrow \bigcup_{j=0}^{C-1} dp[j]$
    \STATE \RETURN $\mathcal{R}$
  \end{algorithmic}
\end{algorithm}


\begin{algorithm}
  \caption{DP algorithm for $[\mathdutchcal{u}\oslash C]_{\geq}$}
  \begin{algorithmic}[1]
    \REQUIRE a dictionary $A \leftarrow \mathrm{supp}(\mathdutchcal{u})$ and a constant $C \in M$
    \ENSURE a list $\mathcal{R}$ of subsets of $A$, s.t. $\forall R \in \mathcal{R},\; \sum_{\mathbf{x}\in R}\mathbf{x}^{(M)} \geq C$
    \STATE Let $T \gets \sum_{\mathbf{x}\in A}\mathbf{x}^{(M)}$
    \STATE Initialize $dp[0] \leftarrow \{\emptyset\}$
    \FOR{$j \gets 1$ \TO $T$}
      \STATE $dp[j] \leftarrow \emptyset$
    \ENDFOR
    \FOR{$i \gets 1$ \TO $|A|$}
      \STATE $w \gets A^{(M)}[i]$, $g \gets A^{(K)}[i]$
      \FOR{$j \gets T, T-1, \dots, w$}
        \STATE $p \gets j - w$
        \IF{$dp[p] \neq \emptyset$}
          \FORALL{$S \in dp[p]$}
            \STATE append $S \cup \{g\}$ to $dp[j]$
          \ENDFOR
        \ENDIF
      \ENDFOR
    \ENDFOR
    \STATE $\mathcal{R} \leftarrow \bigcup_{j=C}^{T} dp[j]$
    \STATE \RETURN $\mathcal{R}$
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{DP algorithm for $[\mathdutchcal{u}\oslash C]_{\leq}$}
  \begin{algorithmic}[1]
    \REQUIRE a dictionary $A \leftarrow \mathrm{supp}(\mathdutchcal{u})$ and a constant $C \in M$
    \ENSURE a list $\mathcal{R}$ of subsets of $A$, s.t. $\forall R \in \mathcal{R},\; \sum_{\mathbf{x}\in R}\mathbf{x}^{(M)} \leq C$
    \STATE Initialize $dp[0] \leftarrow \{\emptyset\}$
    \FOR{$j \gets 1$ \TO $C$}
      \STATE $dp[j] \leftarrow \emptyset$
    \ENDFOR
    \FOR{$i \gets 1$ \TO $|A|$}
      \STATE $w \gets A^{(M)}[i]$, $g \gets A^{(K)}[i]$
      \FOR{$j \gets C, C-1, \dots, w$}
        \STATE $p \gets j - w$
        \IF{$dp[p] \neq \emptyset$}
          \FORALL{$S \in dp[p]$}
            \STATE append $S \cup \{g\}$ to $dp[j]$
          \ENDFOR
        \ENDIF
      \ENDFOR
    \ENDFOR
    \STATE $\mathcal{R} \leftarrow \bigcup_{j=0}^{C} dp[j]$
    \STATE \RETURN $\mathcal{R}$
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}
  \caption{Probability computation for $[\mathdutchcal{u}\oslash C]_=$}
  \begin{algorithmic}[1]
    \REQUIRE list $\mathcal{R}$ of subsets from Algorithm~1, the dictionary $A\leftarrow\mathrm{supp}(\mathdutchcal{u})$, probabilities $p(g)$ for all $g \in \mathcal{G}$
    \ENSURE $\Pr\big([\mathdutchcal{u}\oslash C]_=\big)$
    \FORALL{$S \in \mathcal{R}$}
      \STATE $\pi \gets 1$
      \FORALL{$g \in \mathcal{G}$}
        \IF{$g \in S$}
          \STATE $\pi \gets \pi \cdot p(g)$
        \ELSE
          \STATE $\pi \gets \pi \cdot (1 - p(g))$
        \ENDIF
      \ENDFOR
      \STATE $P \gets P + \pi$
    \ENDFOR
    \STATE \RETURN $P$
  \end{algorithmic}
\end{algorithm}


